<html>
    <head>
        <link rel="stylesheet" href="/static/bootstrap.min.css">
        <link rel="stylesheet" href="/static/main.css">
    </head>
    <body>
        <!-- HEADER  -->
        <header>
            <h1 class='title'>
                {{ name }}
            </h1>
            <h4 class='subheader'>
                {{ netid }}
            </h4>
        </header>
        
        <!-- BODY CONTENT -->
        <div class='content'>
            <!-- input -->
            <div class="form-inline global-search">
                <div class="form-group">
                    <input id="musical-input" type="text" name="search" class="form-control" placeholder="broadway show">
                </div>
                <button id="search-btn" class="btn btn-info"> 
                    BRING IT! 
                </button>
            </div>
        
            <!-- output -->
            <div id='output-container'>
                <div id='results'>
                    <h2 id='output-msg' class='ennio-font'>
                        Because you like <i>{{query_title}}</i>, you might also like:
                    </h2>
                    <div class='output-list'>
                    {% for d in data %}  
                        <p>{{d}}</p>
                    {% endfor %}
                    </div>
                </div>
            </div>
        </div>
        

        <!-- jquery -->
        <script type="text/javascript" src="../static/jquery-3.4.0.min.js"></script>
        <script type="text/javascript" language="javascript">

            var outputMessage = document.getElementById("output-msg");
            outputMessage.style.display = 'none';
            outputMessage.style.fontFamily = 'ennio';


            $('#search-btn').click(function(){
                console.log('clicked')
                query = document.getElementById('musical-input').value;
                if(query) {
                    $( document ).ajaxError(function( event, request, settings ) {
                        $( "#output-container" ).html( "<p id='error-msg'>We couldn't find '" + decodeURIComponent(query) + "'... check your spelling and try again!</p>" );
                    });
                    // show output message
                    outputMessage.style.display = 'block';

                    query = encodeURIComponent(query.trim())
                    console.log(query)
                    let url = window.location.href + '?search=' + query;
                    
                    $('#output-container').load(url + ' #results');
                } else {
                    outputMessage.style.display = 'none';
                }
            });

            $('#musical-input').keypress(function(e){
                if(e.which == 13){//Enter key pressed
                    $('#search-btn').click();//Trigger search button click event
                }
            });

        </script>

    </body>
</html>

